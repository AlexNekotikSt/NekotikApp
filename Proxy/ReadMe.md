# Реалізація патерну «Проксі (Proxy)» для управління доступом, кешуванням та логуванням операцій над віджетами

## Мета

Створити проміжний об’єкт, який контролює та розширює функціональність основного сервісу роботи з віджетами. Основні цілі:

- **Централізована перевірка прав доступу** без змін у бізнес-логіці
- **Механізм кешування** для зменшення навантаження на джерело даних
- **Гнучке логування** викликів методів і параметрів

## Контекст та передумови

У проекті існує інтерфейс для роботи з віджетами, який наразі реалізується класом, що безпосередньо взаємодіє з базою даних або файловим сховищем. Поточна бізнес-логіка не містить жодних перевірок прав чи оптимізаційних механізмів. Для підвищення безпеки, продуктивності та відстеження операцій необхідно впровадити шар-проксі.

## Загальний опис рішення

Проксі-об’єкт повинен імплементувати той самий інтерфейс, що й реальний сервіс, та здійснювати:

1. Перевірку авторизації поточного користувача
2. Читання та оновлення кешу результатів звернень
3. Логування кожного методу (назва, параметри, час виконання, статус)

### Основні складові

- **Інтерфейс сервісу** — описує операції над віджетами: перелік, завантаження за ідентифікатором, збереження, видалення
- **Реальний сервіс** — базові операції над даними без додаткових перевірок
- **Проксі-сервіс** — обгортка над реальним сервісом з:
  - Авторизацією
  - Кешуванням
  - Логуванням
- **Модулі** авторизації, кешування, логування — окремі класи/сервіси, підключені через DI

## Функціональні вимоги

### Контроль доступу

1. Перед викликом методів перевіряти наявність ролей/привілеїв
2. За відсутності доступу повертати помилку без виклику реального сервісу

### Кешування

1. Зберігати результати списків та одиночних віджетів у пам’яті протягом налаштованого інтервалу
2. Оновлювати кеш після операцій збереження або видалення

### Логування

1. Фіксувати початок і кінець кожного методу
2. Логувати параметри запиту, час виконання, статус
3. Записувати логи у файл, базу даних або віддалений сервіс

## Композиція проксі

Підтримка створення ланцюжків проксі-об’єктів (авторизація → кешування → логування).

## Нефункціональні вимоги

- **Продуктивність**: доданий оверхед ≤ 10% порівняно з прямим викликом
- **Гнучкість**: налаштування кешу, авторизації та логування через конфігурацію
- **Тестованість**: можливість заміни реалізацій на мок-версії для юніт-тестів
- **Надійність**: вихід з режиму кешу/логування при відмові компонента з відповідним повідомленням

## Послідовність виконання операцій

1. Клієнт викликає метод проксі
2. Проксі перевіряє права користувача
3. Якщо операція читання — перевірка кешу:
   - Данні у кеші → повернути після логування
   - Нема данй → виклик реального сервісу
4. Операції запису/видалення → виклик реального сервісу
5. Оновлення або очищення кешу
6. Логування результату
7. Повернення відповіді клієнту

## Інтеграція та налаштування

- **DI-контейнер**: реєстрація проксі та модулів у єдиному контейнері
- **Конфігурація**: параметри кешу, правила авторизації, рівень логів зі змінних середовища або файлу налаштувань

## Критерії приймання

1. Усі операції сервісу доступні через проксі без змін у клієнтському коді
2. Наявність юніт‑тестів для сценаріїв:
   - доступ дозволено/заборонено
   - кеш спрацьовує/не спрацьовує
   - логування фіксується
3. Документація конфігурації та приклади використання

## Додаткові побажання

- Відкриття метрик (кількість хітів кешу) для моніторингу
- Опис архітектурного рішення для презентації команді