# Використання патерну «Фасад» для спрощення роботи з віджетами

## Мета

Спростити взаємодію клієнтського коду з підсистемою роботи з віджетами шляхом створення єдиного узагальненого інтерфейсу (**фасаду**), який інкапсулює складну логіку збереження, оновлення, пошуку, фільтрації, валідації та збору статистики.

## Загальний опис системи

У системі наявні окремі підсистеми, які відповідають за:

-  **Збереження віджетів** (у базу даних, файл, тощо)
-  **Редагування / Відновлення стану** (через патерн Memento)
-  **Обчислення статистики** (через Visitor)
-  **Валідацію** значень
-  **Фільтрацію** за запитами (через Interpreter)

Кожна з підсистем має власні API, залежності, формати та правила — це створює складність у використанні та збільшує зв’язність компонентів.


## Рішення: Патерн Facade

Запроваджується сервіс `WidgetFacadeService`, який забезпечує централізовану точку доступу до всіх підсистем.


## Функціональні вимоги до фасаду

1. Сервіс `WidgetFacadeService` має надавати такі методи:

```csharp
void Save(WidgetBase widget);
void UndoChanges(WidgetBase widget);
void ApplyValidation(WidgetBase widget);
StatisticsDto GetStatistics(IEnumerable<WidgetBase> widgets);
IEnumerable<WidgetBase> Filter(IEnumerable<WidgetBase> widgets, string query);
string Export(IEnumerable<WidgetBase> widgets);
WidgetBase Clone(WidgetBase widget);
```

2. Взаємодія з підсистемами
- Фасад повинен делегувати виклики та координувати роботу:
- WidgetStorageService — збереження/завантаження
- WidgetHistoryManager — збереження та відновлення станів (Memento)
- WidgetValidator — перевірка правил валідності
- WidgetStatisticVisitor — збір статистики (Visitor)
- WidgetFilterInterpreter — розбір і виконання фільтру (Interpreter)
- WidgetExporter — конвертація у JSON/XML тощо


3. Приховання складності. Клієнту достатньо працювати лише через WidgetFacadeService, він не знає про внутрішні сервіси чи деталі їх реалізації.


## Нефункціональні вимоги

- Незалежність від UI — фасад не містить жодної прив’язки до шарів представлення.
- Розширюваність — усі залежності (сервіси) мають впроваджуватися через DI.
- Масштабованість — підтримувати як одиничні об’єкти, так і колекції.
- Тестованість — кожний сервіс і фасад мають бути покриті юніт-тестами окремо.

## Очікуваний результат

- Єдиний вхід до складної системи
- Зменшення зв’язності між модулями
- Збереження гнучкості внутрішньої реалізації
- Можливість легкого розширення та повторного використання