# Патерн «Міст (Bridge)» для взаємодії з віджетами через різні канали зв’язку

## Мета

Розділити абстракцію взаємодії з віджетами від конкретної реалізації обміну даними між міні API сервером і консольним клієнтом. Забезпечити можливість легкої заміни або додавання нових протоколів взаємодії без зміни базової логіки роботи з віджетами.

## Контекст і передумови

У системі існує бізнес-логіка роботи з віджетами, що надає CRUD-операції: отримати список, отримати по ідентифікатору, створити, оновити, видалити. Потрібно підтримати різні механізми транспортування запитів: через HTTP API (мінімальний сервер) та через консольний клієнт без мережевих звернень. Для кожного каналу комунікації реалізується окремий конектор, при цьому бізнес-логіка залишається незмінною.

## Опис рішення

Патерн «Міст» розділяє дві ієрархії:

- **Абстракція** — інтерфейс або базовий клас, що визначає методи CRUD-операцій над віджетами без прив’язки до конкретного каналу зв’язку.
- **Реалізація** — конкретні класи, що виконують транспортні операції через HTTP або локально у консольному режимі.

**Міст** — клас, який тримає в полі посилання на реалізацію й делегує виклики абстракції цій реалізації. Завдяки цьому нові види каналів (WebSocket, gRPC тощо) можна додавати без змін в абстракцію.

## Функціональні вимоги

1. **Абстракція** повинна надавати методи для всіх CRUD-операцій та механізм підключення реалізації.
2. **HTTP-реалізація**:
   - Формувати REST-запити до ендпоінтів API
   - Обробляти JSON-відповіді та конвертувати їх у доменні об’єкти
3. **Консольна реалізація**:
   - Викликати внутрішню бібліотеку роботи з віджетами без мережевих звернень
4. **Міні API сервер**:
   - Приймати HTTP-запити, делегувати їх до бізнес-логіки через міст і повертати JSON
5. **Консольний клієнт**:
   - Ініціювати CRUD-операції через міст, виводити результати в консолі

## Нефункціональні вимоги

- **Розширюваність**: додавання нових реалізацій без зміни абстракції
- **Мінімальні залежності**: відсутність циклічних зв’язків між абстракцією та реалізацією
- **Тестованість**: юніт-тести для кожної реалізації з можливістю підміни мосту на мок-об’єкт
- **Продуктивність**: накладні витрати через міст повинні бути незначними
- **Конфігурованість**: вибір реалізації через параметри командного рядка або файл конфігурації

## Компоненти системи

1. **Інтерфейс абстракції** — опис CRUD-методів над віджетами
2. **HTTP-реалізація** — клас-конектор до API сервера
3. **Локальна реалізація** — конектор до внутрішньої бібліотеки роботи з віджетами
4. **Міст** — делегує виклики абстракції конкретній реалізації
5. **Міні API сервер** — модуль маршрутизації HTTP-запитів на операції мосту
6. **Консольний клієнт** — CLI-додаток, що використовує міст для CRUD-операцій

## Послідовність виконання операцій

1. При запуску завантажується конфігурація з вибором реалізації
2. Створюється екземпляр мосту з переданою реалізацією
3. Клієнтський код викликає метод мосту (наприклад, `GetAllWidgets()`)
4. Міст делегує виклик до реалізації (HTTP-запит або локальний виклик)
5. Реалізація обробляє запит та повертає доменні об’єкти
6. Міст повертає результат клієнту, який виводить або обробляє дані далі

## Вимоги до інтеграції та налаштування

- **Параметри командного рядка** або файл конфігурації для вибору реалізації (HTTP чи локальна)
- **Автоматична реєстрація** мосту та реалізацій у DI-контейнері
- **Логування** інформації про обрану реалізацію при старті

## Критерії приймання

1. Повний набір CRUD-операцій доступний через обидві реалізації без змін клієнтського коду
2. Наявні юніт-тести для роботи мосту з мок-реалізаціями
3. Документація з прикладами конфігурації та запуску Console і API модулів